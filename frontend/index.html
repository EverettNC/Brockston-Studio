<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Brockston Studio - Ultimate Edition</title>
<style>
  :root {
    --gold: #FFC107; 
    --bg: #050505;   
    --panel-bg: rgba(15, 15, 15, 0.95);
    --cyan: #00d2ff;
  }

  body {
    margin: 0;
    height: 100vh;
    background-color: var(--bg);
    color: var(--gold);
    font-family: 'Courier New', monospace; 
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  /* THE WINDOW */
  .studio-container {
    width: 99vw;
    height: 98vh;
    border: 1px solid var(--gold);
    border-radius: 8px;
    display: grid;
    grid-template-rows: 40px 1fr 200px; /* Header | Middle | Terminal */
    box-shadow: 0 0 20px rgba(255, 193, 7, 0.15);
    background: var(--bg);
  }

  /* HEADER */
  .header {
    border-bottom: 1px solid var(--gold);
    display: flex;
    align-items: center;
    padding: 0 15px;
    background: #111;
    font-weight: bold;
    letter-spacing: 1.5px;
  }
  .traffic-lights { display: flex; gap: 8px; margin-right: 20px; }
  .dot { width: 12px; height: 12px; border-radius: 50%; }
  .red { background: #ff5f56; } .yellow { background: #ffbd2e; } .green { background: #27c93f; }

  /* MIDDLE AREA - 4 COLUMNS */
  .middle-area {
    display: grid;
    /* 1. Tools (Narrow) | 2. Files (Medium) | 3. Center (Wide) | 4. Q&A (Medium) */
    grid-template-columns: 60px 220px 1fr 300px; 
    overflow: hidden;
  }

  /* COL 1: EXTREME LEFT (TOOLS) */
  .col-tools {
    border-right: 1px solid #333;
    background: #111;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding-top: 15px;
  }
  .tool-icon {
    width: 30px; height: 30px;
    margin-bottom: 20px;
    border: 1px solid var(--gold);
    border-radius: 4px;
    display: flex; justify-content: center; align-items: center;
    cursor: pointer;
    font-size: 1.2rem;
  }
  .tool-icon:hover { background: var(--gold); color: black; }

  /* COL 2: INSIDE LEFT (FILES) */
  .col-files {
    border-right: 1px solid var(--gold);
    padding: 10px;
    background: var(--panel-bg);
    font-size: 0.85rem;
    overflow-y: auto;
  }
  .folder { color: var(--cyan); margin-bottom: 5px; font-weight: bold; }
  .file { margin-left: 15px; color: #bbb; cursor: pointer; margin-bottom: 3px; }
  .file:hover { color: white; text-decoration: underline; }

  /* COL 3: CENTER (WORKSPACE + CREST) */
  .col-center {
    position: relative;
    background: radial-gradient(circle at center, rgba(0, 20, 40, 0.5) 0%, transparent 80%);
    display: flex;
    flex-direction: column;
    padding: 20px;
    overflow: hidden;
  }
  
  /* The Crest - Acts as a Watermark/Background */
  .crest-bg {
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    max-width: 70%;
    max-height: 70%;
    opacity: 0.4; /* Faded so you can read text over it */
    z-index: 0;
    filter: drop-shadow(0 0 20px var(--cyan));
    pointer-events: none; /* Let clicks pass through to text */
  }
  
  /* The "Corrections" Overlay */
  .workspace-content {
    z-index: 1; /* Sits on top of the crest */
    color: #eee;
    font-family: 'Menlo', monospace;
    white-space: pre-wrap;
  }

  /* COL 4: EXTREME RIGHT (Q&A) */
  .col-qa {
    border-left: 1px solid var(--gold);
    background: var(--panel-bg);
    display: flex;
    flex-direction: column;
  }
  .qa-header {
    padding: 10px;
    border-bottom: 1px solid #333;
    text-align: center;
    color: var(--cyan);
    font-weight: bold;
  }
  .qa-log {
    flex-grow: 1;
    padding: 15px;
    overflow-y: auto;
    font-size: 0.9rem;
  }
  .qa-bubble {
    margin-bottom: 15px;
    padding: 10px;
    border: 1px solid #444;
    border-radius: 6px;
    background: rgba(0,0,0,0.3);
  }

  /* BOTTOM: TERMINAL */
  .terminal-panel {
    border-top: 1px solid var(--gold);
    background: #000;
    padding: 10px;
    display: flex;
    flex-direction: column;
    font-size: 1rem;
  }
  .input-line { display: flex; align-items: center; height: 100%; }
  .cli-input {
    background: transparent; border: none; color: white;
    font-family: inherit; font-size: 1rem; width: 100%;
    outline: none; margin-left: 10px;
  }

</style>
</head>
<body>

<div class="studio-container">
  <div class="header">
    <div class="traffic-lights">
      <div class="dot red"></div><div class="dot yellow"></div><div class="dot green"></div>
    </div>
    <div style="flex-grow:1; text-align:center;">BROCKSTON STUDIO</div>
  </div>

  <div class="middle-area">
    
    <div class="col-tools">
      <div class="tool-icon" title="Settings">‚öôÔ∏è</div>
      <div class="tool-icon" title="Search">üîç</div>
      <div class="tool-icon" title="Extensions">üß©</div>
      <div class="tool-icon" title="Git">üêô</div>
    </div>

    <div class="col-files">
      <div class="folder">> PROJECT_ROOT</div>
      <div class="file">üìÑ app.py</div>
      <div class="file">üìÑ NeuroSymbolicExpert.py</div>
      <div class="folder">> STATIC</div>
      <div class="file">üñºÔ∏è family_crest.jpg</div>
      <div class="folder">> MEMORY</div>
      <div class="file">üß† StillHere_Protocol</div>
    </div>

    <div class="col-center">
      <img src="{{ url_for('static', filename='family_crest.jpg') }}" class="crest-bg" alt="Family Crest">
      
      <div class="workspace-content" id="centerDisplay">
        <div style="color:var(--gold); text-align:center; margin-top:20px;">
          [SYSTEM READY]<br>
          Awaiting corrections...
        </div>
      </div>
    </div>

    <div class="col-qa">
      <div class="qa-header">ASK BROCKSTON / ULTIMATE_EV</div>
      <div class="qa-log" id="qaLog">
        <div class="qa-bubble">
          <span style="color:var(--gold)">[BROCKSTON]:</span><br>
          I am ready to assist. Select a file or ask a question.
        </div>
      </div>
    </div>

  </div>

  <div class="terminal-panel" onclick="document.getElementById('termInput').focus()">
    <div style="color:#666; font-size:0.8rem; margin-bottom:5px;">TERMINAL / DIRECT LINK</div>
    <div class="input-line">
      <span style="color:#27c93f">‚ûú</span> 
      <input type="text" class="cli-input" id="termInput" placeholder="Command..." autofocus>
    </div>
  </div>
</div>

<script>
  const input = document.getElementById('termInput');
  const centerDisplay = document.getElementById('centerDisplay');
  const qaLog = document.getElementById('qaLog');

  // Focus on input
  document.addEventListener('click', () => input.focus());

  input.addEventListener('keypress', async (e) => {
    if (e.key === 'Enter') {
      const text = input.value;
      if(!text) return;
      
      // 1. Clear Input
      input.value = '';

      // 2. Determine where the output goes
      // If it's a question (contains "?"), goes to Right Panel
      // If it's code/command, goes to Center Panel
      const isQuestion = text.includes('?');

      if (isQuestion) {
         // Send to Right Panel (Q&A)
         qaLog.innerHTML += `
           <div class="qa-bubble" style="border-color:#444;">
             <span style="color:#aaa">YOU:</span> ${text}
           </div>
         `;
         // Mock Response
         setTimeout(() => {
           qaLog.innerHTML += `
             <div class="qa-bubble" style="border-color:var(--cyan);">
               <span style="color:var(--cyan)">[ULTIMATE_EV]:</span> Analyzing... <br>
               Here is the insight regarding: "${text}"
             </div>
           `;
           qaLog.scrollTop = qaLog.scrollHeight;
         }, 500);

      } else {
         // Send to Center (Corrections/Work)
         centerDisplay.innerHTML = `
           <div style="color:#fff; background:rgba(0,0,0,0.6); padding:10px; border-radius:4px;">
             <span style="color:#27c93f">‚ûú EXEC:</span> ${text}<br><br>
             [Running Module...]<br>
             [Success]
           </div>
         `;
      }
      
      // (Optional) Send to backend via fetch('/api/derek_direct') here...
    }
  });
</script>

</body>
</html>
